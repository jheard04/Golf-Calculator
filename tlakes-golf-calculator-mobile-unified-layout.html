
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TLake's Golf Calculator</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
      background-color: #f1f8f4;
      color: #2d4739;
    }
    h2 {
      text-align: center;
      font-size: 2em;
      margin-bottom: 10px;
    }
    input, button {
      margin: 5px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 1em;
    }
    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
    table {
      margin-top: 20px;
      border-collapse: collapse;
      width: 100%;
      background-color: white;
      border-radius: 5px;
      overflow: hidden;
    }
    th {
      background-color: #4CAF50;
      color: white;
    }
    th, td {
      padding: 12px;
      border: 1px solid #ddd;
      text-align: center;
    }
    ul {
      background-color: rgba(255, 255, 255, 0.9);
      padding: 15px;
      border-radius: 5px;
      list-style-type: square;
    }
    @media (max-width: 600px) {
      .golfer-row {
        flex-direction: column !important;
        align-items: flex-start !important;
      }
      .golfer-row input {
        width: 100% !important;
        max-width: 300px;
      }
    }
  </style>
</head>
<body>

  <h2>TLake's Golf Calculator</h2>

  <label>Number of Golfers: <input type="number" id="numGolfers" min="2" /></label>
  <button onclick="generateInputs()">Generate Input Fields</button>
  <button onclick="resetForm()">Reset</button>

  <div id="inputs"></div>

  <label>Value per Skin: $<input type="number" id="skinValue" step="0.01" /></label>
  <label>Value per 3-Putt: $<input type="number" id="puttValue" step="0.01" /></label>
  <button onclick="calculateResults()">Calculate</button>

  <div id="results"></div>
  <div id="settlements"></div>

  <script>
    function generateInputs() {
      const num = parseInt(document.getElementById('numGolfers').value);
      const container = document.getElementById('inputs');
      container.innerHTML = '';

      for (let i = 0; i < num; i++) {
        let div = document.createElement('div');
        div.innerHTML = `
          <div class="golfer-row" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
            <label style="min-width: 80px;">Golfer ${i + 1}</label>
            <input type="text" id="name${i}" />
            <label>Skins Won:</label>
            <input type="number" id="skins${i}" min="0" style="width: 80px;" />
            <label>Putts:</label>
            <input type="number" id="puttstotal${i}" min="0" style="width: 80px;" />
            <label>3-Putts:</label>
            <input type="number" id="putts${i}" min="0" style="width: 80px;" />
          </div>
        `;
        container.appendChild(div);
      }
    }

    function resetForm() {
      document.getElementById('numGolfers').value = '';
      document.getElementById('skinValue').value = '';
      document.getElementById('puttValue').value = '';
      document.getElementById('inputs').innerHTML = '';
      document.getElementById('results').innerHTML = '';
      document.getElementById('settlements').innerHTML = '';
    }

    function calculateResults() {
      const num = parseInt(document.getElementById('numGolfers').value);
      const skinValue = parseFloat(document.getElementById('skinValue').value || 0);
      const puttValue = parseFloat(document.getElementById('puttValue').value || 0);
      let golfers = [];

      for (let i = 0; i < num; i++) {
        let name = document.getElementById(`name${i}`).value;
        if (!name.trim()) name = `Golfer ${i + 1}`;
        const skins = parseInt(document.getElementById(`skins${i}`).value || 0);
        const puttstotal = parseInt(document.getElementById(`puttstotal${i}`).value || 0);
        const putts = parseInt(document.getElementById(`putts${i}`).value || 0);
        golfers.push({ name, skins, putts, puttstotal, money: 0 });
      }

      // Pairwise skins logic (each comparison only once)
      for (let i = 0; i < num; i++) {
        for (let j = 0; j < num; j++) {
          if (i !== j) {
            let diff = golfers[i].skins - golfers[j].skins;
            if (diff > 0) {
              let amount = diff * skinValue;
              golfers[i].money += amount;
              golfers[j].money -= amount;
            }
          }
        }
      }

      // 3-putts penalty
      let total3PuttMoney = 0;
      let fewestTotalPutts = Math.min(...golfers.map(g => g.puttstotal));
      let winners = golfers.filter(g => g.puttstotal === fewestTotalPutts);

      golfers.forEach(g => {
        if (g.puttstotal !== fewestTotalPutts) {
          g.money -= g.putts * puttValue;
          total3PuttMoney += g.putts * puttValue;
        }
      });

      let share = total3PuttMoney / winners.length;
      winners.forEach(w => {
        w.money += share;
      });

      golfers.forEach(g => g.money = parseFloat(g.money.toFixed(2)));

      let resultsHtml = `<h3>Results</h3><table><tr><th>Name</th><th>Skins Won</th><th>3-Putts</th><th>Money (Â±)</th></tr>`;
      golfers.forEach(g => {
        resultsHtml += `<tr>
          <td>${g.name}</td>
          <td>${g.skins}</td>
          <td>${g.putts}</td>
          <td>${g.money >= 0 ? '+$' + g.money.toFixed(2) : '-$' + Math.abs(g.money).toFixed(2)}</td>
        </tr>`;
      });
      resultsHtml += `</table>`;
      document.getElementById('results').innerHTML = resultsHtml;

      // Settle-up logic
      let debtors = golfers.filter(g => g.money < 0).map(g => ({ name: g.name, amount: -g.money }));
      let creditors = golfers.filter(g => g.money > 0).map(g => ({ name: g.name, amount: g.money }));

      let settlementHtml = `<h3>Settle Up</h3><ul>`;
      let i = 0, j = 0;

      while (i < debtors.length && j < creditors.length) {
        let pay = Math.min(debtors[i].amount, creditors[j].amount);
        settlementHtml += `<li><strong>${debtors[i].name}</strong> pays <strong>${creditors[j].name}</strong> $${pay.toFixed(2)}</li>`;
        debtors[i].amount -= pay;
        creditors[j].amount -= pay;
        if (debtors[i].amount < 0.01) i++;
        if (creditors[j].amount < 0.01) j++;
      }

      settlementHtml += `</ul>`;
      document.getElementById('settlements').innerHTML = settlementHtml;
    }
  </script>

</body>
</html>
